<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Market as a Mirror</title>
  <link rel="stylesheet" href="assets/css/styles.css">
  <link rel="stylesheet" href="assets/vendor/vis-timeline/vis-timeline-graph2d.min.css">
  <script src="assets/vendor/vis-timeline/vis-timeline-graph2d.min.js"></script>

</head>
<body>
<header class="site-header-nav">
    <div class="header-left">
        <a href="#" class="header-logo">The Market as a Mirror</a>
    </div>
    <nav class="header-nav">
        <ul>
            <li><a href="#intro">Overview</a></li>
            <li><a href="#research-questions">Research</a></li>
            <li><a href="#methodology">Methodology</a></li>
            <li><a href="#story">Story</a></li>
        </ul>
    </nav>
</header>
<div class="hero-title animate-title">
  <h1 class="title-main">The Market as a Mirror</h1>
  <h2 class="title-sub">
    How Global Events Shape Finance (2000–2025)
  </h2>
</div>

<div class="hero-bridge">
  <p class="bridge-kicker">Abstract</p>
  <p class="bridge-text">
        Over the past 25 years, the world has been repeatedly shaken by events that escaped prediction and control. Terrorist attacks, natural disasters, technological breakthroughs, political ruptures, and global health crises have punctuated recent history.
</div>

<div style="width: 100%; height: 800px;">
    <iframe 
        src="assets/visualizations/nasdaq_performance.html" 
        width="100%" 
        height="100%" 
        frameborder="0" 
        scrolling="no">
    </iframe>
</div>



<div class="hero-intro animate-intro" id="intro">
    <p class="intro-label">A market seen through its pulse</p>
    <p class="intro-text">
      Financial markets are not just cold algorithms or rational systems. They are living, social organisms shaped by collective excitement and fear. Beneath charts and models lies a system that reacts, hesitates, panics and adapts.
      <br><br>
      At first glance, the NASDAQ 100 from 2000 to 2025 appears stable as a long-term rise. Yet the curve is not smooth,  just like a pulse under stress. It carries drops, recoveries and sudden disruptions moments when the market loses its balance.
      <br><br>
      Some of these movements align with major events, such as the 2008 financial crisis. Others remain harder to explain. We will examine six landmark U.S. events to explore how crises translate into market behavior.
    </p>
</div>

    <div class="timeline-container">
      <div id="timeline"></div>
    </div>
      <script type="module">
        import { getAllEventItems } from './assets/js/eventUtils.js';

        async function renderTimeline() {
          const items = new vis.DataSet(await getAllEventItems());
          const options = {
            autoResize: false,
            zoomable: true,
            showCurrentTime: false,
            locale: 'en',
          };
          const container = document.getElementById('timeline');
          return new vis.Timeline(container, items, options);
        }

        renderTimeline().catch(error => {
          console.error('Failed to render timeline', error);
        });
      </script>

    <div class="intro-research" id="research-questions">
      <h4 class="intro-subheading">The four research questions</h4>
      <p class="intro-text">
        This data story is structured around four core questions, each corresponding to a chapter in our analysis.
        These questions guide our exploration from immediate reaction to long-term recovery, from observation to interpretation.
      </p>

      <ul class="research-list">
        <li class="research-card">
          <a class="research-link" href="#story">
            <div class="research-number">01</div>
            <div class="research-copy">
              <h5 class="research-title">The Anatomy: Fear or Euphoria?</h5>
              <p class="research-desc">
                When a shock occurs, how does it first manifest in the market? Which assets plummet or surge, and where does trading turn abnormal?
              </p>
            </div>
          </a>
        </li>

        <li class="research-card">
          <a class="research-link" href="#sectoral">
            <div class="research-number">02</div>
            <div class="research-copy">
              <h5 class="research-title">Sectoral Natural Selection</h5>
              <p class="research-desc">
                Are sectoral reactions random, or do different types of crises consistently favor or penalize specific industries?
              </p>
            </div>
          </a>
        </li>

        <li class="research-card">
          <a class="research-link" href="#contagion">
            <div class="research-number">03</div>
            <div class="research-copy">
              <h5 class="research-title">The Speed of Recovery</h5>
              <p class="research-desc">
                How long does it take for the market to recover after a shock, and what does the recovery pace reveal about the nature of the crisis?
              </p>
            </div>
          </a>
        </li>

        <li class="research-card">
          <a class="research-link" href="#resilience">
            <div class="research-number">04</div>
            <div class="research-copy">
              <h5 class="research-title">Predicting Resilience</h5>
              <p class="research-desc">
                Is resilience purely circumstantial, or can structural characteristics explain why some sectors consistently recover faster than others?
              </p>
            </div>
          </a>
        </li>
      </ul>
    </div>

  <div class="methodology-section" id="methodology">
    <p class="section-label">Methodology</p>
    <p class="methodology-intro">
      To understand how markets feel, react, and recover, we perform a systematic
      autopsy of financial crises. Each chapter dissects a different mechanism through
      which global events translate into market behavior.
    </p>

    <div class="methodology-block sampling-block">
      <div class="methodology-copy">
        <p class="method-kicker">Data construction & sampling strategy</p>
        <h4 class="method-block-title">Méthodologie</h4>
        <ul class="method-list">
          <li><strong>Stock selection.</strong> The initial dataset (more than 8,000 assets) required rigorous selection to create a representative and usable sample.</li>
          <li><strong>Exclusion of ETFs.</strong> These instruments are composed of several stocks, often from different sectors. We excluded them to avoid ambiguity in sector analysis.</li>
          <li><strong>Classification.</strong> Stocks were classified across six sectors and segmented by market capitalisation size (small, medium, large).</li>
          <li><strong>Sampling.</strong> Ten stocks were selected for each sector-size combination, giving 30 shares per sector.</li>
          <li><strong>Assembly.</strong> Results were pooled by sector using averages to ensure robustness and limit the influence of isolated company behaviour.</li>
        </ul>
      </div>
      <div class="method-visual">
        <div class="method-visual-inner">
          <p class="method-visual-title">Sampling schematic</p>
          <p class="method-visual-desc">Left: full universe (8k+). Right: curated per sector/size. Placeholder graphic.</p>
        </div>
      </div>
    </div>

    <div class="metrics-block">
      <div class="methodology-copy">
        <p class="method-kicker">Quantitative measures</p>
        <h4 class="method-block-title">Mathematics behind analysis</h4>
        <p class="method-paragraph">
          In order to characterise the reaction of financial markets to the events studied, the analysis is based on three main quantitative variables: cumulative abnormal returns (CAR), drawdown (in depth and duration) and recovery time after an event.
        </p>
      </div>

      <div class="metric-grid">
        <div class="metric-card">
          <div class="metric-topline">
            <div>
              <div class="metric-title">CAR</div>
              <div class="metric-subtitle">Relative to QQQ</div>
            </div>
            <span class="metric-tag">Performance</span>
          </div>
          <p class="metric-intuition">
            CAR measures the performance of an asset relative to the market (QQQ), isolating sector-specific moves from the broad trend.
          </p>
          <pre class="metric-formula">AR<sub>i,t</sub> = R<sub>i,t</sub> - R<sub>m,t</sub>
CAR<sub>i</sub>(t<sub>1</sub>, t<sub>2</sub>) = Σ AR<sub>i,t</sub></pre>
          <ul class="metric-interpretation">
            <li><strong>Positive:</strong> outperforming the market.</li>
            <li><strong>Negative:</strong> underperforming the market.</li>
          </ul>
        </div>

        <div class="metric-card">
          <div class="metric-topline">
            <div>
              <div class="metric-title">Drawdown</div>
              <div class="metric-subtitle">Depth & duration</div>
            </div>
            <span class="metric-tag">Risk</span>
          </div>
          <p class="metric-intuition">
            Drawdown captures the maximum loss from a peak and how long it takes to climb back, revealing shock severity and persistence.
          </p>
          <pre class="metric-formula">DD<sub>t</sub> = (P<sub>t</sub> - max(P)) / max(P)
depth = min(DD<sub>t</sub>)
duration = t<sub>reclaim</sub> - t<sub>peak</sub></pre>
          <ul class="metric-interpretation">
            <li><strong>Deep:</strong> high exposure to downside risk.</li>
            <li><strong>Long:</strong> slow absorption and correction of the shock.</li>
          </ul>
        </div>

        <div class="metric-card">
          <div class="metric-topline">
            <div>
              <div class="metric-title">Recovery</div>
              <div class="metric-subtitle">Time back to pre-event</div>
            </div>
            <span class="metric-tag">Resilience</span>
          </div>
          <p class="metric-intuition">
            Recovery time measures how quickly an asset returns to its pre-event peak; if never regained, the horizon is censored.
          </p>
          <pre class="metric-formula">T<sub>rec</sub> = t<sub>rec</sub> - t<sub>peak</sub></pre>
          <ul class="metric-interpretation">
            <li><strong>Short:</strong> fast rebound and resilient sector.</li>
            <li><strong>Long/NA:</strong> persistent damage or incomplete recovery.</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="chapter-section fear-section" id="story">
    <div class="fear-copy">
      <h3 class="section-label">The Anatomy of Fear</h3>
      <p>
        In moments of crisis, fear is often the first emotion to reach financial markets.
        In this chapter, we examine how sudden global shocks trigger spikes in volatility,
        abnormal trading volumes, and sharp price movements.
      </p>
      <p>
        By aligning crisis timelines with market indicators, we identify the initial
        physiological response of the market — its reflexive reaction to uncertainty.
      </p>
    </div>

    <div class="fear-sticky">
      <div class="fear-sticky-inner">
        <div class="fear-sticky-left">
          <div class="fear-sticky-title"></div>
          <div class="chip-row">
            <span class="chip-row-label">Event</span>
            <div class="chip-row-items" id="event-chips"></div>
          </div>
          <div class="chip-row">
            <span class="chip-row-label">Sector</span>
            <div class="chip-row-items" id="sector-chips"></div>
          </div>
        </div>
        <div class="fear-sticky-right">
          <div class="selection-status" id="selection-status">
            Selected: —
          </div>
          <div class="update-hint" id="update-hint">Updated</div>
        </div>
      </div>
    </div>

    <div class="fear-charts">
      <div class="chart-card chart-card-full">
        <div class="chart-card-header">
          <div class="chart-title">CAR</div>
          <div class="chart-subtitle">Cumulative abnormal returns around the event</div>
        </div>
        <div class="chart-body">
          <img id="chart-car" alt="CAR chart" loading="lazy">
          <div class="chart-missing" data-for="chart-car">Image not available</div>
        </div>
      </div>

      <div class="chart-card chart-card-full">
        <div class="chart-card-header">
          <div class="chart-title">Drawdown</div>
          <div class="chart-subtitle">Depth and duration of market drops</div>
        </div>
        <div class="chart-body">
          <img id="chart-drawdown" alt="Drawdown chart" loading="lazy">
          <div class="chart-missing" data-for="chart-drawdown">Image not available</div>
        </div>
      </div>

      <div class="chart-card chart-card-full">
        <div class="chart-card-header">
          <div class="chart-title">Volcano</div>
          <div class="chart-subtitle">Cross-sectional impact during the shock</div>
        </div>
        <div class="chart-body">
          <img id="chart-volcano" alt="Volcano chart" loading="lazy">
          <div class="chart-missing" data-for="chart-volcano">Image not available</div>
        </div>
      </div>
    </div>

  </div>
  <script type="module">
    import { getAllEvents } from './assets/js/eventUtils.js';
    import { getAllSectors } from './assets/js/sectorUtils.js';
    import { getChartPaths } from './assets/js/chartPathUtils.js';

    const CORAL = '#f9624f';
    const eventChips = document.getElementById('event-chips');
    const sectorChips = document.getElementById('sector-chips');
    const statusEl = document.getElementById('selection-status');
    const updateHint = document.getElementById('update-hint');

    const chartEls = {
      car: document.getElementById('chart-car'),
      drawdown: document.getElementById('chart-drawdown'),
      volcano: document.getElementById('chart-volcano')
    };

    const missingEls = {
      car: document.querySelector('[data-for="chart-car"]'),
      drawdown: document.querySelector('[data-for="chart-drawdown"]'),
      volcano: document.querySelector('[data-for="chart-volcano"]')
    };

    let events = [];
    let sectors = [];
    let selectedEventId = null;
    let selectedSectorKey = null;
    let hintTimer = null;

    function setChipVisual(chip, active) {
      chip.classList.toggle('active', active);
    }

    function renderEventChips() {
      eventChips.innerHTML = '';
      events.forEach(event => {
        const chip = document.createElement('button');
        chip.className = 'chip';
        chip.style.setProperty('--chip-color', CORAL);
        chip.textContent = event.name;
        setChipVisual(chip, event.id === selectedEventId);
        chip.addEventListener('click', () => {
          if (selectedEventId === event.id) return;
          selectedEventId = event.id;
          renderEventChips();
          updateSelection();
        });
        eventChips.appendChild(chip);
      });
    }

    function renderSectorChips() {
      sectorChips.innerHTML = '';
      sectors.forEach(sector => {
        const chip = document.createElement('button');
        chip.className = 'chip';
        chip.style.setProperty('--chip-color', sector.color || CORAL);
        chip.textContent = sector.label;
        setChipVisual(chip, String(sector.key) === String(selectedSectorKey));
        chip.addEventListener('click', () => {
          if (String(selectedSectorKey) === String(sector.key)) return;
          selectedSectorKey = sector.key;
          renderSectorChips();
          updateSelection();
        });
        sectorChips.appendChild(chip);
      });
    }

    function updateStatus() {
      const event = events.find(item => item.id === selectedEventId);
      const sector = sectors.find(item => String(item.key) === String(selectedSectorKey));
      if (!event || !sector) {
        statusEl.textContent = 'Selected: —';
        return;
      }
      statusEl.textContent = `Selected: ${event.name} × ${sector.label}`;
    }

    function showUpdateHint() {
      updateHint.classList.add('show');
      if (hintTimer) clearTimeout(hintTimer);
      hintTimer = setTimeout(() => updateHint.classList.remove('show'), 900);
    }

    function setChart(target, missingEl, src, alt) {
      if (!target || !missingEl) return;
      if (!src) {
        target.removeAttribute('src');
        missingEl.classList.add('visible');
        return;
      }
      missingEl.classList.remove('visible');
      target.onload = () => missingEl.classList.remove('visible');
      target.onerror = () => {
        missingEl.classList.add('visible');
        target.removeAttribute('src');
      };
      target.src = src;
      target.alt = alt;
    }

    async function updateCharts() {
      const paths = await getChartPaths(selectedEventId, selectedSectorKey);
      const event = events.find(item => item.id === selectedEventId);
      const sector = sectors.find(item => String(item.key) === String(selectedSectorKey));
      const descriptor = event && sector ? `${event.name} × ${sector.label}` : '';

      setChart(chartEls.car, missingEls.car, paths.car, `CAR — ${descriptor}`);
      setChart(chartEls.drawdown, missingEls.drawdown, paths.drawdown, `Drawdown — ${descriptor}`);
      setChart(chartEls.volcano, missingEls.volcano, paths.volcano, `Volcano — ${descriptor}`);
    }

    async function updateSelection() {
      updateStatus();
      await updateCharts();
      showUpdateHint();
    }

    (async function initFear() {
      events = await getAllEvents();
      sectors = await getAllSectors();

      if (!events.length || !sectors.length) return;

      selectedEventId = events[0].id;
      selectedSectorKey = sectors[0].key;

      renderEventChips();
      renderSectorChips();
      await updateSelection();
    })().catch(error => {
      console.error('Failed to initialize fear section', error);
    });
  </script>
  <div class="chapter-section" id="sectoral">
    <h3>Sectoral Natural Selection</h3>
    <p>
      Not all sectors react equally to crises. Some absorb shocks, while others amplify
      them. In this chapter, we analyze sector-level performance to identify patterns
      of resilience and vulnerability.
    </p>
    <p>
      We compare returns, drawdowns, and recovery paths across industries to understand
      how capital reallocates under stress.
    </p>

    <div class="fear-sticky heatmap-sticky">
      <div class="fear-sticky-inner">
        <div class="fear-sticky-left">
          <div class="fear-sticky-title">Sectoral Natural Selection</div>
          <div class="chip-row">
            <span class="chip-row-label">Event</span>
            <div class="chip-row-items" id="heatmap-event-chips"></div>
          </div>
        </div>
        <div class="fear-sticky-right">
          <div class="selection-status" id="heatmap-selection-status">Selected: —</div>
          <div class="update-hint" id="heatmap-update-hint">Updated</div>
        </div>
      </div>
    </div>

    <div class="chart-card chart-card-full">
      <div class="chart-card-header">
        <div class="chart-title">Sector Heatmap</div>
        <div class="chart-subtitle">Evolution of sector performance around the event</div>
      </div>
      <div class="chart-body">
        <img id="heatmap-img" alt="Sector heatmap" loading="lazy">
        <div class="chart-missing" data-for="heatmap-img">Image not available</div>
      </div>
    </div>

  </div>
  <script type="module">
    import { getAllEvents } from './assets/js/eventUtils.js';
    import { getSectorHeatmapPath } from './assets/js/chartPathUtils.js';

    const CORAL2 = '#f9624f';
    const heatmapEventChips = document.getElementById('heatmap-event-chips');
    const heatmapStatusEl = document.getElementById('heatmap-selection-status');
    const heatmapUpdateHint = document.getElementById('heatmap-update-hint');
    const heatmapImg = document.getElementById('heatmap-img');
    const heatmapMissing = document.querySelector('[data-for="heatmap-img"]');

    let heatmapEvents = [];
    let selectedHeatmapEventId = null;
    let heatmapHintTimer = null;

    function setChipVisual(chip, active) {
      chip.classList.toggle('active', active);
    }

    function renderHeatmapEventChips() {
      heatmapEventChips.innerHTML = '';
      heatmapEvents.forEach(event => {
        const chip = document.createElement('button');
        chip.className = 'chip';
        chip.style.setProperty('--chip-color', CORAL2);
        chip.textContent = event.name;
        setChipVisual(chip, event.id === selectedHeatmapEventId);
        chip.addEventListener('click', () => {
          if (selectedHeatmapEventId === event.id) return;
          selectedHeatmapEventId = event.id;
          renderHeatmapEventChips();
          updateHeatmap();
        });
        heatmapEventChips.appendChild(chip);
      });
    }

    function showHeatmapHint() {
      heatmapUpdateHint.classList.add('show');
      if (heatmapHintTimer) clearTimeout(heatmapHintTimer);
      heatmapHintTimer = setTimeout(() => heatmapUpdateHint.classList.remove('show'), 900);
    }

    function updateHeatmapStatus() {
      const event = heatmapEvents.find(item => item.id === selectedHeatmapEventId);
      heatmapStatusEl.textContent = event ? `Selected: ${event.name}` : 'Selected: —';
    }

    function setHeatmapImage(src, alt) {
      if (!heatmapImg || !heatmapMissing) return;
      if (!src) {
        heatmapImg.removeAttribute('src');
        heatmapMissing.classList.add('visible');
        return;
      }
      heatmapMissing.classList.remove('visible');
      heatmapImg.onload = () => heatmapMissing.classList.remove('visible');
      heatmapImg.onerror = () => {
        heatmapMissing.classList.add('visible');
        heatmapImg.removeAttribute('src');
      };
      heatmapImg.src = src;
      heatmapImg.alt = alt;
    }

    async function updateHeatmap() {
      const path = await getSectorHeatmapPath(selectedHeatmapEventId);
      const event = heatmapEvents.find(item => item.id === selectedHeatmapEventId);
      const descriptor = event ? `Sector Heatmap — ${event.name}` : 'Sector Heatmap';
      updateHeatmapStatus();
      setHeatmapImage(path, descriptor);
      showHeatmapHint();
    }

    (async function initHeatmap() {
      heatmapEvents = await getAllEvents();
      if (!heatmapEvents.length) return;
      selectedHeatmapEventId = heatmapEvents[0].id;
      renderHeatmapEventChips();
      await updateHeatmap();
    })().catch(error => {
      console.error('Failed to initialize heatmap section', error);
    });
  </script>
  <div class="chapter-section" id="contagion">
    <h3>The Speed of Contagion</h3>
    <p>
      Crises rarely stay confined to one market or sector. In this chapter, we study
      how shocks propagate across assets, regions, and industries.
    </p>
    <p>
      By measuring reaction delays and cross-sector correlations, we capture the
      velocity at which fear and optimism spread through the financial system.
    </p>
    <div class="viz-placeholder">[ Sector Heatmap Placeholder ]</div>

  </div>
  <div class="chapter-section" id="resilience">
    <h3>Predicting Resilience</h3>
    <p>
      Some assets recover faster than others. In this chapter, we investigate which
      pre-crisis signals can help predict post-crisis resilience.
    </p>
    <p>
      We explore whether early indicators — such as trading behavior or sentiment shifts —
      provide clues about an asset’s ability to rebound.
    </p>
    <div class="viz-placeholder">[ Sector Heatmap Placeholder ]</div>

  </div>
  <div class="chapter-section">
    <h3>Crisis Playbook — The Action Guide</h3>
    <p>
      Finally, we synthesize our findings into a practical framework.
      This chapter translates historical patterns into insights that help
      interpret future crises.
    </p>
    <p>
      Rather than predicting the next shock, our goal is to understand how markets
      are likely to react — and how fear, resilience, and recovery tend to unfold.
    </p>
    <div class="viz-placeholder">[ Sector Heatmap Placeholder ]</div>

  </div>
  <div class="chapter-section">
    <h3>Conclusion</h3>
    <p>
      Conclusion
    </p>
  </div>

  <footer class="site-footer">
    <p>
      ADA Project · DataPandas · EPFL © 2025
    </p>
  </footer>
  
</body>
</html>
